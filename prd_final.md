# AI ê¸°ë°˜ ì½”ë”© êµìœ¡ ì½˜í…ì¸  ìë™ ìƒì„±ê¸° PRD v3.1
## ì„±ì¸ ëŒ€ìƒ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ íŠ¹í™” + í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œìŠ¤í…œ

---

# Executive Summary

| í•­ëª© | ë‚´ìš© |
|------|------|
| **í”„ë¡œì íŠ¸ëª…** | CodeGen AI - ì½”ë”© êµìœ¡ ì½˜í…ì¸  ìë™ ìƒì„±ê¸° |
| **ë²„ì „** | 3.1 (í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œìŠ¤í…œ í¬í•¨) |
| **ì‘ì„±ì¼** | 2025ë…„ 1ì›” 28ì¼ |
| **íƒ€ê²Ÿ ì‚¬ìš©ì** | ì„±ì¸ í•™ìŠµì ëŒ€ìƒ ì½”ë”© ê°•ì‚¬, ê¸°ì—… ê°œë°œ êµìœ¡ ë‹´ë‹¹ì |
| **í•µì‹¬ ê°€ì¹˜** | "10ë¶„ ì•ˆì— ì‹¤ë¬´í˜• ì½”ë”© êµìœ¡ ì½˜í…ì¸  ì™„ì„±" |
| **ê²°ì œ ì‹œìŠ¤í…œ** | í† ìŠ¤í˜ì´ë¨¼ì¸  (ì •ê¸°ê²°ì œ + ë‹¨ê±´ê²°ì œ) |

---

# Part A: íƒ€ê²Ÿ ë° ì‹œì¥ ë¶„ì„

## 1. íƒ€ê²Ÿ ì‚¬ìš©ì ì„¸ë¶„í™”

### 1.1 í•™ìŠµì í˜ë¥´ì†Œë‚˜ (ì„±ì¸ ì „ìš©)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì„±ì¸ ì½”ë”© í•™ìŠµì 4ëŒ€ í˜ë¥´ì†Œë‚˜                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [A: ë¹„ì „ê³µ ì§ì¥ì¸]        [B: ì£¼ë‹ˆì–´ ê°œë°œì]                          â”‚
â”‚  â”œâ”€ ë§ˆì¼€íŒ…, ê¸°íš, ì˜ì—…     â”œâ”€ ì „ê³µì/ë¶€íŠ¸ìº í”„ ìˆ˜ë£Œ                     â”‚
â”‚  â”œâ”€ ì—…ë¬´ ìë™í™”, ë¶„ì„ ëª©í‘œ  â”œâ”€ ì‹ ê¸°ìˆ  ìŠµë“, ì‹¤ë¬´ ê°•í™”                   â”‚
â”‚  â””â”€ ë¹„ìœ : ì—‘ì…€, ì—…ë¬´ ë„êµ¬   â””â”€ ë¹„ìœ : ì–¸ì–´ ë¹„êµ, ì•„í‚¤í…ì²˜                â”‚
â”‚                                                                     â”‚
â”‚  [C: ê´€ë¦¬ì/ì„ì›]          [D: ì»¤ë¦¬ì–´ ì „í™˜ì]                          â”‚
â”‚  â”œâ”€ PM, CTO, ì°½ì—…ì        â”œâ”€ íƒ€ ì—…ì¢… ê²½ë ¥ì                          â”‚
â”‚  â”œâ”€ ê¸°ìˆ  ì´í•´, íŒ€ ì†Œí†µ     â”œâ”€ ê°œë°œì ì·¨ì—…, í¬íŠ¸í´ë¦¬ì˜¤                  â”‚
â”‚  â””â”€ ë¹„ìœ : ì¡°ì§, ê²½ì˜       â””â”€ ë¹„ìœ : ë²”ìš© (ìš”ë¦¬, ê±´ì¶•)                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2. ì§€ì› í”„ë¡œê·¸ë˜ë° ì–¸ì–´

| ìš°ì„ ìˆœìœ„ | ì–¸ì–´ | íƒ€ê²Ÿ | ë¹„ìœ  ë„ë©”ì¸ |
|---------|------|------|-----------|
| **P0** | Python | ë¹„ì „ê³µì, ë°ì´í„° ë¶„ì„ | ì—‘ì…€, ì—…ë¬´ ìë™í™” |
| **P0** | JavaScript | ì›¹ ê°œë°œ ì…ë¬¸ | ì›¹í˜ì´ì§€, ì¸í„°ë™ì…˜ |
| **P1** | SQL | ê¸°íšì, ë§ˆì¼€í„° | ì—‘ì…€ í•„í„°, í”¼ë²— |
| **P1** | Java | ê¸°ì—… ê°œë°œì | ì„¤ê³„ë„, ê³µì¥ |
| **P2** | TypeScript | ì£¼ë‹ˆì–´ ê°œë°œì | JS + ê³„ì•½ì„œ |
| **P2** | Go | ë°±ì—”ë“œ ê°œë°œì | íš¨ìœ¨ì  ê³µì¥ |

---

# Part B: ì „ë¬¸ê°€ í˜ë¥´ì†Œë‚˜ ê²€í† 

## 3. ê²€í†  íŒ¨ë„ (7ì¸)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Expert Review Panel (7ì¸)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [êµìœ¡]                    [ê¸°ìˆ ]                   [ë¹„ì¦ˆë‹ˆìŠ¤]        â”‚
â”‚  ğŸ‘¨â€ğŸ« ì„±ì¸êµìœ¡ ì „ë¬¸ê°€         ğŸ’» ì‹œë‹ˆì–´ ê°œë°œì          ğŸ“Š ë¶€íŠ¸ìº í”„ ìš´ì˜ì â”‚
â”‚  ğŸ“ ê¸°ì—…êµìœ¡ ì„¤ê³„ì (ISD)   ğŸ”§ DevRel               ğŸ’¼ ê¸°ì—… HRD       â”‚
â”‚                                                                     â”‚
â”‚  [ê²°ì œ/ë³´ì•ˆ]                                                         â”‚
â”‚  ğŸ’³ PG ì—°ë™ ì „ë¬¸ê°€ (ì‹ ê·œ)                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. ğŸ’³ PG ì—°ë™ ì „ë¬¸ê°€ ê²€í† 

### í† ìŠ¤í˜ì´ë¨¼ì¸  ì„ ì • ì´ìœ 

| í•­ëª© | í† ìŠ¤í˜ì´ë¨¼ì¸  | ê²½ìŸì‚¬ A | ê²½ìŸì‚¬ B |
|------|------------|---------|---------|
| ê°œë°œì ë¬¸ì„œ | â­â­â­â­â­ | â­â­â­ | â­â­â­ |
| í…ŒìŠ¤íŠ¸ í™˜ê²½ | ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥ | ì‹ ì²­ í•„ìš” | ì‹ ì²­ í•„ìš” |
| ì •ê¸°ê²°ì œ | ë¹Œë§í‚¤ ë°©ì‹ | ê°€ëŠ¥ | ê°€ëŠ¥ |
| ìˆ˜ìˆ˜ë£Œ | 3.3% | 3.5% | 3.4% |
| Next.js ì§€ì› | ê³µì‹ SDK | ì»¤ë®¤ë‹ˆí‹° | ë¹„ê³µì‹ |
| ì›¹í›… ì•ˆì •ì„± | ë†’ìŒ | ì¤‘ê°„ | ì¤‘ê°„ |

### ê²°ì œ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
[í•„ìˆ˜ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­]
â˜‘ ì‹œí¬ë¦¿ í‚¤ ì„œë²„ ì‚¬ì´ë“œë§Œ ì €ì¥ (í™˜ê²½ë³€ìˆ˜)
â˜‘ í´ë¼ì´ì–¸íŠ¸ì— ì‹œí¬ë¦¿ í‚¤ ë…¸ì¶œ ê¸ˆì§€
â˜‘ ê²°ì œ ê¸ˆì•¡ ì„œë²„ ì‚¬ì´ë“œ ê²€ì¦
â˜‘ ì›¹í›… ì„œëª… ê²€ì¦
â˜‘ HTTPS í•„ìˆ˜
â˜‘ PCI-DSS ì¤€ìˆ˜ (í† ìŠ¤í˜ì´ë¨¼ì¸ ê°€ ì²˜ë¦¬)

[ê¶Œì¥ ë³´ì•ˆ ì‚¬í•­]
â˜ ê²°ì œ ìš”ì²­ ì¤‘ë³µ ë°©ì§€ (ë©±ë“±ì„± í‚¤)
â˜ ì´ìƒ ê²°ì œ íƒì§€ ë¡œì§
â˜ ê²°ì œ ì‹œë„ íšŸìˆ˜ ì œí•œ
â˜ í™˜ë¶ˆ ê¶Œí•œ ë¶„ë¦¬
```

---

# Part C: ê²°ì œ ì‹œìŠ¤í…œ ìƒì„¸ ì„¤ê³„

## 5. ê°€ê²© ì •ì±…

### 5.1 ìš”ê¸ˆì œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CodeGen AI ìš”ê¸ˆì œ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [Starter]          [Pro]              [Team]         [Enterprise]  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ë¬´ë£Œ               â‚©29,900/ì›”         â‚©99,000/ì›”     ë¬¸ì˜          â”‚
â”‚                     (ì—° â‚©299,000)      (ì—° â‚©990,000)                â”‚
â”‚                     17% í• ì¸           17% í• ì¸                      â”‚
â”‚                                                                     â”‚
â”‚  â€¢ 10íšŒ/ì¼          â€¢ 100íšŒ/ì¼         â€¢ 500íšŒ/ì¼     â€¢ ë¬´ì œí•œ      â”‚
â”‚  â€¢ Pythonë§Œ         â€¢ ì „ì²´ ì–¸ì–´        â€¢ ì „ì²´ ì–¸ì–´    â€¢ ì „ì²´ ì–¸ì–´   â”‚
â”‚  â€¢ ê¸°ë³¸ ê¸°ëŠ¥        â€¢ ì „ì²´ ê¸°ëŠ¥        â€¢ ì „ì²´ ê¸°ëŠ¥    â€¢ ì „ì²´ ê¸°ëŠ¥   â”‚
â”‚                     â€¢ PDF ë‚´ë³´ë‚´ê¸°     â€¢ API ì œê³µ     â€¢ ì „ìš© ì§€ì›   â”‚
â”‚                     â€¢ íˆìŠ¤í† ë¦¬ 30ì¼    â€¢ íˆìŠ¤í† ë¦¬ ë¬´ì œí•œ â€¢ ì˜¨í”„ë ˆë¯¸ìŠ¤â”‚
â”‚                                        â€¢ 5ëª… ê³„ì •                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 í† í°/í¬ë ˆë”§ ì¶”ê°€ êµ¬ë§¤

| íŒ¨í‚¤ì§€ | ê°€ê²© | ìƒì„± íšŸìˆ˜ | ë‹¨ê°€ | ìœ íš¨ê¸°ê°„ |
|--------|------|----------|------|---------|
| Basic | â‚©9,900 | 50íšŒ | â‚©198/íšŒ | 90ì¼ |
| Standard | â‚©24,900 | 150íšŒ | â‚©166/íšŒ | 90ì¼ |
| Premium | â‚©49,900 | 350íšŒ | â‚©143/íšŒ | 180ì¼ |

---

## 6. í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™ ì•„í‚¤í…ì²˜

### 6.1 ê²°ì œ í”Œë¡œìš° ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ í”Œë¡œìš°                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [ë‹¨ê±´ ê²°ì œ - í† í° ì¶”ê°€ êµ¬ë§¤]                                         â”‚
â”‚                                                                     â”‚
â”‚  Client              Server              TossPayments               â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 1. ê²°ì œ ìš”ì²­       â”‚                      â”‚                     â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚                     â”‚
â”‚    â”‚                   â”‚ 2. ì£¼ë¬¸ ìƒì„±          â”‚                     â”‚
â”‚    â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 3. ê²°ì œì°½ í˜¸ì¶œ (SDK)                      â”‚                     â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 4. ê²°ì œ ì™„ë£Œ (ë¦¬ë‹¤ì´ë ‰íŠ¸)                  â”‚                     â”‚
â”‚    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 5. ê²°ì œ ìŠ¹ì¸ ìš”ì²­  â”‚                      â”‚                     â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ 6. ìŠ¹ì¸ API í˜¸ì¶œ     â”‚                     â”‚
â”‚    â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚
â”‚    â”‚                   â”‚ 7. ìŠ¹ì¸ ê²°ê³¼         â”‚                     â”‚
â”‚    â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚    â”‚ 8. ê²°ê³¼ ë°˜í™˜      â”‚                      â”‚                     â”‚
â”‚    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚                     â”‚
â”‚                                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                     â”‚
â”‚  [ì •ê¸° ê²°ì œ - êµ¬ë…]                                                  â”‚
â”‚                                                                     â”‚
â”‚  Client              Server              TossPayments               â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 1. êµ¬ë… ì‹ ì²­       â”‚                      â”‚                     â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 2. ë¹Œë§í‚¤ ë°œê¸‰ ì°½  â”‚                      â”‚                     â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 3. ì¹´ë“œ ì •ë³´ ì…ë ¥ ì™„ë£Œ                     â”‚                     â”‚
â”‚    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚ 4. authKey ì „ë‹¬   â”‚                      â”‚                     â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ 5. ë¹Œë§í‚¤ ë°œê¸‰ ìš”ì²­   â”‚                     â”‚
â”‚    â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚
â”‚    â”‚                   â”‚ 6. billingKey ë°˜í™˜   â”‚                     â”‚
â”‚    â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚    â”‚                   â”‚                      â”‚                     â”‚
â”‚    â”‚                   â”‚ [ë§¤ì›” ê²°ì œì¼]         â”‚                     â”‚
â”‚    â”‚                   â”‚ 7. ìë™ ê²°ì œ ìš”ì²­     â”‚                     â”‚
â”‚    â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚
â”‚    â”‚                   â”‚ 8. ê²°ì œ ê²°ê³¼         â”‚                     â”‚
â”‚    â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚    â”‚                   â”‚ 9. ì›¹í›… ìˆ˜ì‹          â”‚                     â”‚
â”‚    â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (ê²°ì œ í¬í•¨)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CodeGen AI - Full Architecture                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [Client Layer]                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Next.js App                                                  â”‚  â”‚
â”‚  â”‚  â”œâ”€ ì½˜í…ì¸  ìƒì„± UI                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ ê²°ì œ í˜ì´ì§€ (í† ìŠ¤í˜ì´ë¨¼ì¸  SDK)                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ êµ¬ë… ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ                                        â”‚  â”‚
â”‚  â”‚  â””â”€ ê²°ì œ ì™„ë£Œ/ì‹¤íŒ¨ í˜ì´ì§€                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  [API Layer]                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FastAPI Server                                               â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/content/*     (ì½˜í…ì¸  ìƒì„±)                          â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/payment/*     (ê²°ì œ ì²˜ë¦¬)                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/subscription/*(êµ¬ë… ê´€ë¦¬)                            â”‚  â”‚
â”‚  â”‚  â””â”€ /api/webhook/toss  (ì›¹í›… ìˆ˜ì‹ )                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â–¼                    â–¼                    â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Content   â”‚      â”‚  Payment   â”‚      â”‚Subscriptionâ”‚           â”‚
â”‚  â”‚  Service   â”‚      â”‚  Service   â”‚      â”‚  Service   â”‚           â”‚
â”‚  â”‚            â”‚      â”‚            â”‚      â”‚            â”‚           â”‚
â”‚  â”‚ â€¢ ìƒì„±     â”‚      â”‚ â€¢ ë‹¨ê±´ê²°ì œ â”‚      â”‚ â€¢ êµ¬ë…ìƒì„± â”‚           â”‚
â”‚  â”‚ â€¢ ê²€ì¦     â”‚      â”‚ â€¢ ìŠ¹ì¸     â”‚      â”‚ â€¢ ë¹Œë§í‚¤   â”‚           â”‚
â”‚  â”‚ â€¢ ë‚´ë³´ë‚´ê¸° â”‚      â”‚ â€¢ í™˜ë¶ˆ     â”‚      â”‚ â€¢ ìë™ê²°ì œ â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                    â”‚                    â”‚                â”‚
â”‚         â”‚                    â–¼                    â”‚                â”‚
â”‚         â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚                â”‚
â”‚         â”‚           â”‚TossPaymentsâ”‚                â”‚                â”‚
â”‚         â”‚           â”‚   API      â”‚                â”‚                â”‚
â”‚         â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                â”‚
â”‚         â”‚                    â”‚                    â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                              â–¼                                      â”‚
â”‚  [Data Layer]                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL                                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ users              (ì‚¬ìš©ì)                               â”‚  â”‚
â”‚  â”‚  â”œâ”€ subscriptions      (êµ¬ë… ì •ë³´)                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ billing_keys       (ë¹Œë§í‚¤ - ì•”í˜¸í™”)                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ payments           (ê²°ì œ ë‚´ì—­)                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ credits            (í¬ë ˆë”§/í† í°)                          â”‚  â”‚
â”‚  â”‚  â””â”€ generated_contents (ìƒì„± ì½˜í…ì¸ )                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  [Scheduler]                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Cron Jobs (ì •ê¸° ê²°ì œ ì²˜ë¦¬)                                    â”‚  â”‚
â”‚  â”‚  â”œâ”€ ë§¤ì¼ 00:00 - ë‹¹ì¼ ê²°ì œ ëŒ€ìƒ ì¡°íšŒ                           â”‚  â”‚
â”‚  â”‚  â”œâ”€ ê²°ì œ ì‹¤í–‰ (ì¬ì‹œë„ ë¡œì§ í¬í•¨)                               â”‚  â”‚
â”‚  â”‚  â””â”€ ê²°ì œ ì‹¤íŒ¨ ì‹œ ì•Œë¦¼ ë°œì†¡                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (ê²°ì œ ê´€ë ¨)

```sql
-- =====================================================
-- ì‚¬ìš©ì í…Œì´ë¸” (í™•ì¥)
-- =====================================================
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),
    name VARCHAR(100),
    
    -- ìš”ê¸ˆì œ ì •ë³´
    plan VARCHAR(20) DEFAULT 'starter',  -- starter, pro, team, enterprise
    plan_started_at TIMESTAMP,
    plan_expires_at TIMESTAMP,
    
    -- í¬ë ˆë”§ ì •ë³´
    credits_remaining INTEGER DEFAULT 10,
    credits_reset_at TIMESTAMP,
    
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- =====================================================
-- êµ¬ë… í…Œì´ë¸”
-- =====================================================
CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    
    -- êµ¬ë… ì •ë³´
    plan VARCHAR(20) NOT NULL,           -- pro, team
    billing_cycle VARCHAR(10) NOT NULL,  -- monthly, yearly
    amount INTEGER NOT NULL,              -- ê²°ì œ ê¸ˆì•¡ (ì›)
    
    -- ìƒíƒœ
    status VARCHAR(20) DEFAULT 'active', -- active, cancelled, past_due, expired
    
    -- ê²°ì œ ì£¼ê¸°
    current_period_start TIMESTAMP NOT NULL,
    current_period_end TIMESTAMP NOT NULL,
    next_billing_date DATE NOT NULL,
    
    -- ì·¨ì†Œ ì •ë³´
    cancelled_at TIMESTAMP,
    cancel_at_period_end BOOLEAN DEFAULT FALSE,
    cancellation_reason TEXT,
    
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_subscriptions_user ON subscriptions(user_id);
CREATE INDEX idx_subscriptions_next_billing ON subscriptions(next_billing_date);
CREATE INDEX idx_subscriptions_status ON subscriptions(status);

-- =====================================================
-- ë¹Œë§í‚¤ í…Œì´ë¸” (ì•”í˜¸í™” ì €ì¥)
-- =====================================================
CREATE TABLE billing_keys (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    subscription_id UUID REFERENCES subscriptions(id) ON DELETE CASCADE,
    
    -- í† ìŠ¤í˜ì´ë¨¼ì¸  ë¹Œë§í‚¤ (ì•”í˜¸í™”)
    billing_key_encrypted TEXT NOT NULL,  -- AES-256 ì•”í˜¸í™”
    
    -- ì¹´ë“œ ì •ë³´ (ë§ˆìŠ¤í‚¹)
    card_company VARCHAR(50),             -- ì¹´ë“œì‚¬
    card_number_masked VARCHAR(20),       -- **** **** **** 1234
    card_type VARCHAR(20),                -- ì‹ ìš©, ì²´í¬
    
    -- ìƒíƒœ
    is_active BOOLEAN DEFAULT TRUE,
    
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_billing_keys_user ON billing_keys(user_id);

-- =====================================================
-- ê²°ì œ ë‚´ì—­ í…Œì´ë¸”
-- =====================================================
CREATE TABLE payments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE SET NULL,
    subscription_id UUID REFERENCES subscriptions(id) ON DELETE SET NULL,
    
    -- í† ìŠ¤í˜ì´ë¨¼ì¸  ì •ë³´
    toss_payment_key VARCHAR(200) UNIQUE, -- paymentKey
    toss_order_id VARCHAR(100) NOT NULL,  -- orderId
    
    -- ê²°ì œ ì •ë³´
    payment_type VARCHAR(20) NOT NULL,    -- one_time, subscription
    product_type VARCHAR(50) NOT NULL,    -- pro_monthly, credits_50, etc.
    amount INTEGER NOT NULL,               -- ê²°ì œ ê¸ˆì•¡
    
    -- ìƒíƒœ
    status VARCHAR(20) NOT NULL,          -- pending, completed, failed, cancelled, refunded
    
    -- ê²°ì œ ìˆ˜ë‹¨ ì •ë³´
    method VARCHAR(30),                   -- ì¹´ë“œ, ê³„ì¢Œì´ì²´, ê°€ìƒê³„ì¢Œ
    card_company VARCHAR(50),
    card_number_masked VARCHAR(20),
    
    -- ì˜ìˆ˜ì¦
    receipt_url TEXT,
    
    -- ì‹¤íŒ¨ ì •ë³´
    failure_code VARCHAR(50),
    failure_message TEXT,
    
    -- í™˜ë¶ˆ ì •ë³´
    refunded_amount INTEGER DEFAULT 0,
    refunded_at TIMESTAMP,
    refund_reason TEXT,
    
    paid_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_payments_user ON payments(user_id);
CREATE INDEX idx_payments_toss_order ON payments(toss_order_id);
CREATE INDEX idx_payments_status ON payments(status);
CREATE INDEX idx_payments_created ON payments(created_at DESC);

-- =====================================================
-- í¬ë ˆë”§ ê±°ë˜ ë‚´ì—­
-- =====================================================
CREATE TABLE credit_transactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    payment_id UUID REFERENCES payments(id) ON DELETE SET NULL,
    
    -- ê±°ë˜ ì •ë³´
    transaction_type VARCHAR(20) NOT NULL, -- purchase, use, refund, bonus, reset
    amount INTEGER NOT NULL,                -- ë³€ë™ëŸ‰ (+/-)
    balance_after INTEGER NOT NULL,         -- ê±°ë˜ í›„ ì”ì•¡
    
    -- ìƒì„¸
    description TEXT,
    
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_credit_tx_user ON credit_transactions(user_id);

-- =====================================================
-- ê²°ì œ ì›¹í›… ë¡œê·¸
-- =====================================================
CREATE TABLE webhook_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    
    -- ì›¹í›… ì •ë³´
    event_type VARCHAR(50) NOT NULL,       -- PAYMENT_STATUS_CHANGED, etc.
    payload JSONB NOT NULL,
    
    -- ì²˜ë¦¬ ê²°ê³¼
    processed BOOLEAN DEFAULT FALSE,
    processed_at TIMESTAMP,
    error_message TEXT,
    
    received_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_webhook_processed ON webhook_logs(processed);
```

---

## 8. API ì—”ë“œí¬ì¸íŠ¸ (ê²°ì œ)

### 8.1 ê²°ì œ API ëª…ì„¸

```yaml
# =====================================================
# ê²°ì œ ê´€ë ¨ API ì—”ë“œí¬ì¸íŠ¸
# =====================================================

# ë‹¨ê±´ ê²°ì œ (í¬ë ˆë”§ êµ¬ë§¤)
POST /api/v1/payment/credits:
  summary: í¬ë ˆë”§ íŒ¨í‚¤ì§€ ê²°ì œ ì‹œì‘
  request:
    body:
      package_type: "basic" | "standard" | "premium"
  response:
    order_id: string
    amount: number
    order_name: string
    customer_key: string

POST /api/v1/payment/confirm:
  summary: ê²°ì œ ìŠ¹ì¸ (í† ìŠ¤í˜ì´ë¨¼ì¸  â†’ ì„œë²„)
  request:
    body:
      payment_key: string   # í† ìŠ¤í˜ì´ë¨¼ì¸  paymentKey
      order_id: string
      amount: number
  response:
    success: boolean
    payment_id: string
    credits_added: number

# êµ¬ë… ê²°ì œ
POST /api/v1/subscription/create:
  summary: êµ¬ë… ì‹œì‘ (ë¹Œë§í‚¤ ë°œê¸‰ ìš”ì²­)
  request:
    body:
      plan: "pro" | "team"
      billing_cycle: "monthly" | "yearly"
  response:
    customer_key: string
    # í´ë¼ì´ì–¸íŠ¸ì—ì„œ í† ìŠ¤ ë¹Œë§í‚¤ ë°œê¸‰ ì°½ í˜¸ì¶œ

POST /api/v1/subscription/confirm:
  summary: ë¹Œë§í‚¤ ë°œê¸‰ ì™„ë£Œ ë° ì²« ê²°ì œ
  request:
    body:
      auth_key: string      # í† ìŠ¤ì—ì„œ ë°›ì€ authKey
      customer_key: string
  response:
    success: boolean
    subscription_id: string
    next_billing_date: string

DELETE /api/v1/subscription/{subscription_id}:
  summary: êµ¬ë… ì·¨ì†Œ
  request:
    body:
      reason: string
      cancel_immediately: boolean  # true: ì¦‰ì‹œ, false: ê¸°ê°„ ì¢…ë£Œ ì‹œ
  response:
    success: boolean
    cancel_at: string

# êµ¬ë… ì¡°íšŒ
GET /api/v1/subscription/current:
  summary: í˜„ì¬ êµ¬ë… ì •ë³´ ì¡°íšŒ
  response:
    plan: string
    status: string
    current_period_end: string
    next_billing_date: string
    payment_method:
      card_company: string
      card_number_masked: string

# ê²°ì œ ë‚´ì—­
GET /api/v1/payments:
  summary: ê²°ì œ ë‚´ì—­ ì¡°íšŒ
  query:
    page: number
    limit: number
  response:
    payments: Payment[]
    total: number

# í™˜ë¶ˆ ìš”ì²­
POST /api/v1/payment/{payment_id}/refund:
  summary: í™˜ë¶ˆ ìš”ì²­
  request:
    body:
      amount: number        # ë¶€ë¶„ í™˜ë¶ˆ ì‹œ ê¸ˆì•¡
      reason: string
  response:
    success: boolean
    refunded_amount: number

# ì›¹í›…
POST /api/v1/webhook/toss:
  summary: í† ìŠ¤í˜ì´ë¨¼ì¸  ì›¹í›… ìˆ˜ì‹ 
  headers:
    TossPayments-Signature: string  # ì„œëª… ê²€ì¦ìš©
  request:
    body:
      eventType: string
      data: object
```

---

## 9. í•µì‹¬ ì½”ë“œ êµ¬í˜„

### 9.1 í† ìŠ¤í˜ì´ë¨¼ì¸  ì„œë¹„ìŠ¤ í´ë˜ìŠ¤

```python
# services/payment_service.py

import httpx
import base64
from datetime import datetime, timedelta
from typing import Optional
from pydantic import BaseModel

class TossPaymentsService:
    """í† ìŠ¤í˜ì´ë¨¼ì¸  API ì—°ë™ ì„œë¹„ìŠ¤"""
    
    BASE_URL = "https://api.tosspayments.com/v1"
    
    def __init__(self, secret_key: str):
        # Base64 ì¸ì½”ë”©ëœ ì‹œí¬ë¦¿ í‚¤ (ì‹œí¬ë¦¿í‚¤:)
        self.auth_header = base64.b64encode(
            f"{secret_key}:".encode()
        ).decode()
        
        self.headers = {
            "Authorization": f"Basic {self.auth_header}",
            "Content-Type": "application/json"
        }
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ë‹¨ê±´ ê²°ì œ
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    async def confirm_payment(
        self, 
        payment_key: str, 
        order_id: str, 
        amount: int
    ) -> dict:
        """ê²°ì œ ìŠ¹ì¸"""
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{self.BASE_URL}/payments/confirm",
                headers=self.headers,
                json={
                    "paymentKey": payment_key,
                    "orderId": order_id,
                    "amount": amount
                }
            )
            
            if response.status_code != 200:
                error = response.json()
                raise PaymentError(
                    code=error.get("code"),
                    message=error.get("message")
                )
            
            return response.json()
    
    async def cancel_payment(
        self,
        payment_key: str,
        cancel_reason: str,
        cancel_amount: Optional[int] = None  # Noneì´ë©´ ì „ì•¡ ì·¨ì†Œ
    ) -> dict:
        """ê²°ì œ ì·¨ì†Œ/í™˜ë¶ˆ"""
        payload = {"cancelReason": cancel_reason}
        if cancel_amount:
            payload["cancelAmount"] = cancel_amount
        
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{self.BASE_URL}/payments/{payment_key}/cancel",
                headers=self.headers,
                json=payload
            )
            
            if response.status_code != 200:
                error = response.json()
                raise PaymentError(
                    code=error.get("code"),
                    message=error.get("message")
                )
            
            return response.json()
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ì •ê¸° ê²°ì œ (ë¹Œë§)
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    async def issue_billing_key(
        self,
        auth_key: str,
        customer_key: str
    ) -> dict:
        """ë¹Œë§í‚¤ ë°œê¸‰"""
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{self.BASE_URL}/billing/authorizations/issue",
                headers=self.headers,
                json={
                    "authKey": auth_key,
                    "customerKey": customer_key
                }
            )
            
            if response.status_code != 200:
                error = response.json()
                raise PaymentError(
                    code=error.get("code"),
                    message=error.get("message")
                )
            
            return response.json()
    
    async def charge_billing(
        self,
        billing_key: str,
        customer_key: str,
        amount: int,
        order_id: str,
        order_name: str
    ) -> dict:
        """ë¹Œë§í‚¤ë¡œ ìë™ ê²°ì œ"""
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{self.BASE_URL}/billing/{billing_key}",
                headers=self.headers,
                json={
                    "customerKey": customer_key,
                    "amount": amount,
                    "orderId": order_id,
                    "orderName": order_name
                }
            )
            
            if response.status_code != 200:
                error = response.json()
                raise PaymentError(
                    code=error.get("code"),
                    message=error.get("message")
                )
            
            return response.json()
    
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # ì›¹í›… ê²€ì¦
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    def verify_webhook_signature(
        self,
        payload: bytes,
        signature: str
    ) -> bool:
        """ì›¹í›… ì„œëª… ê²€ì¦"""
        import hmac
        import hashlib
        
        expected = hmac.new(
            self.secret_key.encode(),
            payload,
            hashlib.sha256
        ).hexdigest()
        
        return hmac.compare_digest(expected, signature)


class PaymentError(Exception):
    def __init__(self, code: str, message: str):
        self.code = code
        self.message = message
        super().__init__(f"[{code}] {message}")
```

### 9.2 êµ¬ë… ì„œë¹„ìŠ¤

```python
# services/subscription_service.py

from datetime import datetime, date
from dateutil.relativedelta import relativedelta
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, update

class SubscriptionService:
    """êµ¬ë… ê´€ë¦¬ ì„œë¹„ìŠ¤"""
    
    PLANS = {
        "pro": {
            "monthly": {"amount": 29900, "credits": 100},
            "yearly": {"amount": 299000, "credits": 100}
        },
        "team": {
            "monthly": {"amount": 99000, "credits": 500},
            "yearly": {"amount": 990000, "credits": 500}
        }
    }
    
    def __init__(
        self, 
        db: AsyncSession,
        toss_service: TossPaymentsService
    ):
        self.db = db
        self.toss = toss_service
    
    async def create_subscription(
        self,
        user_id: str,
        auth_key: str,
        customer_key: str,
        plan: str,
        billing_cycle: str
    ) -> Subscription:
        """êµ¬ë… ìƒì„± ë° ì²« ê²°ì œ"""
        
        plan_info = self.PLANS[plan][billing_cycle]
        amount = plan_info["amount"]
        
        # 1. ë¹Œë§í‚¤ ë°œê¸‰
        billing_result = await self.toss.issue_billing_key(
            auth_key=auth_key,
            customer_key=customer_key
        )
        
        billing_key = billing_result["billingKey"]
        card_info = billing_result.get("card", {})
        
        # 2. ë¹Œë§í‚¤ ì €ì¥ (ì•”í˜¸í™”)
        encrypted_key = encrypt_billing_key(billing_key)
        
        billing_key_record = BillingKey(
            user_id=user_id,
            billing_key_encrypted=encrypted_key,
            card_company=card_info.get("company"),
            card_number_masked=card_info.get("number"),
            card_type=card_info.get("cardType")
        )
        self.db.add(billing_key_record)
        
        # 3. ì²« ê²°ì œ ì‹¤í–‰
        order_id = generate_order_id()
        order_name = f"CodeGen AI {plan.upper()} ({billing_cycle})"
        
        payment_result = await self.toss.charge_billing(
            billing_key=billing_key,
            customer_key=customer_key,
            amount=amount,
            order_id=order_id,
            order_name=order_name
        )
        
        # 4. êµ¬ë… ì •ë³´ ì €ì¥
        now = datetime.now()
        if billing_cycle == "monthly":
            period_end = now + relativedelta(months=1)
        else:
            period_end = now + relativedelta(years=1)
        
        subscription = Subscription(
            user_id=user_id,
            plan=plan,
            billing_cycle=billing_cycle,
            amount=amount,
            status="active",
            current_period_start=now,
            current_period_end=period_end,
            next_billing_date=period_end.date()
        )
        self.db.add(subscription)
        
        # 5. ê²°ì œ ë‚´ì—­ ì €ì¥
        payment = Payment(
            user_id=user_id,
            subscription_id=subscription.id,
            toss_payment_key=payment_result["paymentKey"],
            toss_order_id=order_id,
            payment_type="subscription",
            product_type=f"{plan}_{billing_cycle}",
            amount=amount,
            status="completed",
            method=payment_result.get("method"),
            card_company=card_info.get("company"),
            card_number_masked=card_info.get("number"),
            receipt_url=payment_result.get("receipt", {}).get("url"),
            paid_at=now
        )
        self.db.add(payment)
        
        # 6. ì‚¬ìš©ì í”Œëœ ì—…ë°ì´íŠ¸
        await self.db.execute(
            update(User)
            .where(User.id == user_id)
            .values(
                plan=plan,
                plan_started_at=now,
                plan_expires_at=period_end,
                credits_remaining=plan_info["credits"]
            )
        )
        
        await self.db.commit()
        
        return subscription
    
    async def cancel_subscription(
        self,
        subscription_id: str,
        reason: str,
        cancel_immediately: bool = False
    ) -> Subscription:
        """êµ¬ë… ì·¨ì†Œ"""
        
        subscription = await self.db.get(Subscription, subscription_id)
        
        if cancel_immediately:
            subscription.status = "cancelled"
            subscription.cancelled_at = datetime.now()
            
            # ì‚¬ìš©ì í”Œëœ ë‹¤ìš´ê·¸ë ˆì´ë“œ
            await self.db.execute(
                update(User)
                .where(User.id == subscription.user_id)
                .values(plan="starter")
            )
        else:
            # ê¸°ê°„ ì¢…ë£Œ ì‹œ ì·¨ì†Œ
            subscription.cancel_at_period_end = True
        
        subscription.cancellation_reason = reason
        
        await self.db.commit()
        
        return subscription
    
    async def process_recurring_payments(self):
        """ì •ê¸° ê²°ì œ ì²˜ë¦¬ (ìŠ¤ì¼€ì¤„ëŸ¬ì—ì„œ í˜¸ì¶œ)"""
        
        today = date.today()
        
        # ì˜¤ëŠ˜ ê²°ì œ ëŒ€ìƒ êµ¬ë… ì¡°íšŒ
        result = await self.db.execute(
            select(Subscription)
            .where(
                Subscription.next_billing_date == today,
                Subscription.status == "active",
                Subscription.cancel_at_period_end == False
            )
        )
        subscriptions = result.scalars().all()
        
        for sub in subscriptions:
            try:
                await self._process_single_payment(sub)
            except PaymentError as e:
                await self._handle_payment_failure(sub, e)
    
    async def _process_single_payment(self, sub: Subscription):
        """ê°œë³„ êµ¬ë… ê²°ì œ ì²˜ë¦¬"""
        
        # ë¹Œë§í‚¤ ì¡°íšŒ ë° ë³µí˜¸í™”
        billing_key_record = await self.db.execute(
            select(BillingKey)
            .where(
                BillingKey.subscription_id == sub.id,
                BillingKey.is_active == True
            )
        )
        billing_key_record = billing_key_record.scalar_one()
        billing_key = decrypt_billing_key(
            billing_key_record.billing_key_encrypted
        )
        
        # ê²°ì œ ì‹¤í–‰
        order_id = generate_order_id()
        result = await self.toss.charge_billing(
            billing_key=billing_key,
            customer_key=str(sub.user_id),
            amount=sub.amount,
            order_id=order_id,
            order_name=f"CodeGen AI {sub.plan.upper()} ì •ê¸°ê²°ì œ"
        )
        
        # êµ¬ë… ê¸°ê°„ ê°±ì‹ 
        now = datetime.now()
        if sub.billing_cycle == "monthly":
            new_period_end = now + relativedelta(months=1)
        else:
            new_period_end = now + relativedelta(years=1)
        
        sub.current_period_start = now
        sub.current_period_end = new_period_end
        sub.next_billing_date = new_period_end.date()
        
        # í¬ë ˆë”§ ë¦¬ì…‹
        plan_info = self.PLANS[sub.plan][sub.billing_cycle]
        await self.db.execute(
            update(User)
            .where(User.id == sub.user_id)
            .values(
                credits_remaining=plan_info["credits"],
                credits_reset_at=now
            )
        )
        
        await self.db.commit()
    
    async def _handle_payment_failure(
        self, 
        sub: Subscription, 
        error: PaymentError
    ):
        """ê²°ì œ ì‹¤íŒ¨ ì²˜ë¦¬"""
        
        # ì‹¤íŒ¨ íšŸìˆ˜ ì²´í¬ (3íšŒê¹Œì§€ ì¬ì‹œë„)
        # past_due ìƒíƒœë¡œ ë³€ê²½
        # ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ ë°œì†¡
        
        sub.status = "past_due"
        await self.db.commit()
        
        # ì´ë©”ì¼/í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡
        await send_payment_failure_notification(
            user_id=sub.user_id,
            error_message=error.message
        )
```

### 9.3 Next.js ê²°ì œ í˜ì´ì§€

```tsx
// app/payment/subscribe/page.tsx

'use client';

import { useState } from 'react';
import { loadTossPayments } from '@tosspayments/payment-sdk';

const TOSS_CLIENT_KEY = process.env.NEXT_PUBLIC_TOSS_CLIENT_KEY!;

interface PlanOption {
  plan: 'pro' | 'team';
  billingCycle: 'monthly' | 'yearly';
  amount: number;
  displayPrice: string;
}

const PLAN_OPTIONS: PlanOption[] = [
  { plan: 'pro', billingCycle: 'monthly', amount: 29900, displayPrice: 'â‚©29,900/ì›”' },
  { plan: 'pro', billingCycle: 'yearly', amount: 299000, displayPrice: 'â‚©299,000/ë…„ (17% í• ì¸)' },
  { plan: 'team', billingCycle: 'monthly', amount: 99000, displayPrice: 'â‚©99,000/ì›”' },
  { plan: 'team', billingCycle: 'yearly', amount: 990000, displayPrice: 'â‚©990,000/ë…„ (17% í• ì¸)' },
];

export default function SubscribePage() {
  const [selectedPlan, setSelectedPlan] = useState<PlanOption | null>(null);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleSubscribe = async () => {
    if (!selectedPlan) return;
    
    setIsLoading(true);
    setError(null);

    try {
      // 1. ì„œë²„ì—ì„œ customerKey ë°œê¸‰
      const response = await fetch('/api/subscription/create', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          plan: selectedPlan.plan,
          billing_cycle: selectedPlan.billingCycle,
        }),
      });

      const { customerKey } = await response.json();

      // 2. í† ìŠ¤í˜ì´ë¨¼ì¸  SDK ë¡œë“œ
      const tossPayments = await loadTossPayments(TOSS_CLIENT_KEY);

      // 3. ë¹Œë§í‚¤ ë°œê¸‰ (ì¹´ë“œ ë“±ë¡) ì°½ í˜¸ì¶œ
      await tossPayments.requestBillingAuth('ì¹´ë“œ', {
        customerKey,
        successUrl: `${window.location.origin}/payment/subscribe/success`,
        failUrl: `${window.location.origin}/payment/subscribe/fail`,
      });
    } catch (err) {
      setError('ê²°ì œ ì¤€ë¹„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      console.error(err);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6">êµ¬ë… í”Œëœ ì„ íƒ</h1>

      <div className="space-y-4">
        {PLAN_OPTIONS.map((option) => (
          <div
            key={`${option.plan}-${option.billingCycle}`}
            onClick={() => setSelectedPlan(option)}
            className={`p-4 border rounded-lg cursor-pointer transition
              ${selectedPlan === option 
                ? 'border-blue-500 bg-blue-50' 
                : 'border-gray-200 hover:border-gray-300'
              }`}
          >
            <div className="flex justify-between items-center">
              <div>
                <span className="font-semibold text-lg">
                  {option.plan.toUpperCase()}
                </span>
                <span className="text-gray-500 ml-2">
                  ({option.billingCycle === 'monthly' ? 'ì›”ê°„' : 'ì—°ê°„'})
                </span>
              </div>
              <span className="text-lg font-bold">{option.displayPrice}</span>
            </div>
            <ul className="mt-2 text-sm text-gray-600">
              <li>â€¢ {option.plan === 'pro' ? '100íšŒ/ì¼' : '500íšŒ/ì¼'} ìƒì„±</li>
              <li>â€¢ ì „ì²´ ì–¸ì–´ ì§€ì›</li>
              <li>â€¢ {option.plan === 'team' ? 'API ì œê³µ + 5ëª… ê³„ì •' : 'PDF ë‚´ë³´ë‚´ê¸°'}</li>
            </ul>
          </div>
        ))}
      </div>

      {error && (
        <div className="mt-4 p-3 bg-red-50 text-red-600 rounded">
          {error}
        </div>
      )}

      <button
        onClick={handleSubscribe}
        disabled={!selectedPlan || isLoading}
        className={`mt-6 w-full py-3 rounded-lg font-semibold text-white
          ${selectedPlan && !isLoading
            ? 'bg-blue-600 hover:bg-blue-700'
            : 'bg-gray-300 cursor-not-allowed'
          }`}
      >
        {isLoading ? 'ì²˜ë¦¬ ì¤‘...' : 'êµ¬ë… ì‹œì‘í•˜ê¸°'}
      </button>

      <p className="mt-4 text-sm text-gray-500 text-center">
        ê²°ì œëŠ” í† ìŠ¤í˜ì´ë¨¼ì¸ ë¥¼ í†µí•´ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.
        <br />
        ì–¸ì œë“ ì§€ êµ¬ë…ì„ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
    </div>
  );
}
```

### 9.4 ê²°ì œ ì„±ê³µ ì²˜ë¦¬

```tsx
// app/payment/subscribe/success/page.tsx

'use client';

import { useEffect, useState } from 'react';
import { useSearchParams, useRouter } from 'next/navigation';

export default function SubscribeSuccessPage() {
  const searchParams = useSearchParams();
  const router = useRouter();
  const [status, setStatus] = useState<'processing' | 'success' | 'error'>('processing');
  const [message, setMessage] = useState('ê²°ì œë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤...');

  useEffect(() => {
    const confirmSubscription = async () => {
      const authKey = searchParams.get('authKey');
      const customerKey = searchParams.get('customerKey');

      if (!authKey || !customerKey) {
        setStatus('error');
        setMessage('ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.');
        return;
      }

      try {
        const response = await fetch('/api/subscription/confirm', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ authKey, customerKey }),
        });

        const result = await response.json();

        if (response.ok) {
          setStatus('success');
          setMessage('êµ¬ë…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
          
          // 3ì´ˆ í›„ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
          setTimeout(() => {
            router.push('/dashboard');
          }, 3000);
        } else {
          setStatus('error');
          setMessage(result.message || 'ê²°ì œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      } catch (err) {
        setStatus('error');
        setMessage('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    };

    confirmSubscription();
  }, [searchParams, router]);

  return (
    <div className="min-h-screen flex items-center justify-center">
      <div className="text-center p-8">
        {status === 'processing' && (
          <div className="animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto" />
        )}
        
        {status === 'success' && (
          <div className="text-6xl mb-4">âœ…</div>
        )}
        
        {status === 'error' && (
          <div className="text-6xl mb-4">âŒ</div>
        )}

        <h1 className="text-2xl font-bold mt-4">{message}</h1>
        
        {status === 'success' && (
          <p className="text-gray-500 mt-2">ì ì‹œ í›„ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™í•©ë‹ˆë‹¤...</p>
        )}
        
        {status === 'error' && (
          <button
            onClick={() => router.push('/payment/subscribe')}
            className="mt-4 px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
          >
            ë‹¤ì‹œ ì‹œë„
          </button>
        )}
      </div>
    </div>
  );
}
```

### 9.5 ì›¹í›… ì²˜ë¦¬

```python
# api/webhook/toss.py

from fastapi import APIRouter, Request, HTTPException, Header
from sqlalchemy.ext.asyncio import AsyncSession

router = APIRouter()

@router.post("/webhook/toss")
async def handle_toss_webhook(
    request: Request,
    toss_signature: str = Header(None, alias="TossPayments-Signature"),
    db: AsyncSession = Depends(get_db)
):
    """í† ìŠ¤í˜ì´ë¨¼ì¸  ì›¹í›… ìˆ˜ì‹ """
    
    # 1. ì›ë³¸ í˜ì´ë¡œë“œ ì¶”ì¶œ
    payload = await request.body()
    
    # 2. ì„œëª… ê²€ì¦
    toss_service = TossPaymentsService(settings.TOSS_SECRET_KEY)
    if not toss_service.verify_webhook_signature(payload, toss_signature):
        raise HTTPException(status_code=401, detail="Invalid signature")
    
    # 3. ì´ë²¤íŠ¸ íŒŒì‹±
    data = await request.json()
    event_type = data.get("eventType")
    
    # 4. ì›¹í›… ë¡œê·¸ ì €ì¥
    webhook_log = WebhookLog(
        event_type=event_type,
        payload=data
    )
    db.add(webhook_log)
    
    # 5. ì´ë²¤íŠ¸ íƒ€ì…ë³„ ì²˜ë¦¬
    try:
        if event_type == "PAYMENT_STATUS_CHANGED":
            await handle_payment_status_changed(db, data)
        elif event_type == "BILLING_KEY_DELETED":
            await handle_billing_key_deleted(db, data)
        # ... ê¸°íƒ€ ì´ë²¤íŠ¸
        
        webhook_log.processed = True
        webhook_log.processed_at = datetime.now()
        
    except Exception as e:
        webhook_log.error_message = str(e)
        raise
    
    finally:
        await db.commit()
    
    return {"success": True}


async def handle_payment_status_changed(db: AsyncSession, data: dict):
    """ê²°ì œ ìƒíƒœ ë³€ê²½ ì²˜ë¦¬"""
    
    payment_data = data.get("data", {})
    payment_key = payment_data.get("paymentKey")
    status = payment_data.get("status")
    
    # ê²°ì œ ìƒíƒœ ì—…ë°ì´íŠ¸
    await db.execute(
        update(Payment)
        .where(Payment.toss_payment_key == payment_key)
        .values(status=map_toss_status(status))
    )


async def handle_billing_key_deleted(db: AsyncSession, data: dict):
    """ë¹Œë§í‚¤ ì‚­ì œ ì²˜ë¦¬ (ì¹´ë“œ ë³€ê²½ ë“±)"""
    
    billing_key = data.get("data", {}).get("billingKey")
    
    # ë¹Œë§í‚¤ ë¹„í™œì„±í™”
    await db.execute(
        update(BillingKey)
        .where(BillingKey.billing_key_encrypted == encrypt_billing_key(billing_key))
        .values(is_active=False)
    )
```

---

## 10. í™˜ë¶ˆ ì •ì±…

### 10.1 í™˜ë¶ˆ ê·œì •

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CodeGen AI í™˜ë¶ˆ ì •ì±…                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [êµ¬ë… í™˜ë¶ˆ]                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                     â”‚
â”‚  â€¢ ê²°ì œ í›„ 7ì¼ ì´ë‚´: ì „ì•¡ í™˜ë¶ˆ                                        â”‚
â”‚    - ë‹¨, í•´ë‹¹ ê¸°ê°„ í¬ë ˆë”§ ì‚¬ìš©ëŸ‰ 50% ë¯¸ë§Œì¸ ê²½ìš°                       â”‚
â”‚    - 50% ì´ìƒ ì‚¬ìš© ì‹œ í™˜ë¶ˆ ë¶ˆê°€                                       â”‚
â”‚                                                                     â”‚
â”‚  â€¢ ê²°ì œ í›„ 7ì¼ ì´ˆê³¼: í™˜ë¶ˆ ë¶ˆê°€                                        â”‚
â”‚    - ë‚¨ì€ ê¸°ê°„ ì¢…ë£Œ ì‹œê¹Œì§€ ì„œë¹„ìŠ¤ ì´ìš© ê°€ëŠ¥                            â”‚
â”‚    - ë‹¤ìŒ ê²°ì œë¶€í„° ìë™ ì·¨ì†Œ                                          â”‚
â”‚                                                                     â”‚
â”‚  â€¢ ì—°ê°„ êµ¬ë… ì¤‘ë„ í•´ì§€:                                               â”‚
â”‚    - ì›”í•  ê³„ì‚° í›„ ì”ì—¬ ê¸°ê°„ í™˜ë¶ˆ (ìˆ˜ìˆ˜ë£Œ 10% ê³µì œ)                     â”‚
â”‚    - ì˜ˆ: 6ê°œì›” ì‚¬ìš© í›„ í•´ì§€ ì‹œ                                        â”‚
â”‚      299,000 Ã· 12 Ã— 6 = 149,500ì› ì‚¬ìš©                               â”‚
â”‚      í™˜ë¶ˆì•¡ = (299,000 - 149,500) Ã— 0.9 = 134,550ì›                  â”‚
â”‚                                                                     â”‚
â”‚  [í¬ë ˆë”§ í™˜ë¶ˆ]                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                     â”‚
â”‚  â€¢ êµ¬ë§¤ í›„ 7ì¼ ì´ë‚´ + ë¯¸ì‚¬ìš©: ì „ì•¡ í™˜ë¶ˆ                               â”‚
â”‚  â€¢ ë¶€ë¶„ ì‚¬ìš©: ë¯¸ì‚¬ìš©ë¶„ í™˜ë¶ˆ (ìµœì†Œ 50% ì´ìƒ ì”ì—¬ ì‹œ)                    â”‚
â”‚  â€¢ ìœ íš¨ê¸°ê°„ ë§Œë£Œ: í™˜ë¶ˆ ë¶ˆê°€                                           â”‚
â”‚                                                                     â”‚
â”‚  [í™˜ë¶ˆ ì²˜ë¦¬ ê¸°ê°„]                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                     â”‚
â”‚  â€¢ ì‹ ìš©ì¹´ë“œ: 3-5 ì˜ì—…ì¼                                              â”‚
â”‚  â€¢ ê³„ì¢Œì´ì²´: 1-2 ì˜ì—…ì¼                                              â”‚
â”‚  â€¢ ê°€ìƒê³„ì¢Œ: 1-2 ì˜ì—…ì¼ (í™˜ë¶ˆ ê³„ì¢Œ í•„ìš”)                              â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 í™˜ë¶ˆ ì²˜ë¦¬ ë¡œì§

```python
# services/refund_service.py

class RefundService:
    """í™˜ë¶ˆ ì²˜ë¦¬ ì„œë¹„ìŠ¤"""
    
    async def process_refund(
        self,
        payment_id: str,
        user_id: str,
        reason: str,
        amount: Optional[int] = None  # Noneì´ë©´ ì „ì•¡
    ) -> RefundResult:
        """í™˜ë¶ˆ ì²˜ë¦¬"""
        
        payment = await self.db.get(Payment, payment_id)
        
        # 1. í™˜ë¶ˆ ê°€ëŠ¥ ì—¬ë¶€ ê²€ì¦
        validation = await self._validate_refund(payment, user_id, amount)
        if not validation.is_valid:
            raise RefundError(validation.error_message)
        
        # 2. í™˜ë¶ˆ ê¸ˆì•¡ ê³„ì‚°
        refund_amount = amount or payment.amount - payment.refunded_amount
        
        # 3. í† ìŠ¤í˜ì´ë¨¼ì¸  í™˜ë¶ˆ ìš”ì²­
        result = await self.toss.cancel_payment(
            payment_key=payment.toss_payment_key,
            cancel_reason=reason,
            cancel_amount=refund_amount
        )
        
        # 4. DB ì—…ë°ì´íŠ¸
        payment.refunded_amount += refund_amount
        payment.refunded_at = datetime.now()
        payment.refund_reason = reason
        
        if payment.refunded_amount >= payment.amount:
            payment.status = "refunded"
        
        # 5. êµ¬ë…ì¸ ê²½ìš° í”Œëœ ë‹¤ìš´ê·¸ë ˆì´ë“œ
        if payment.payment_type == "subscription":
            await self._handle_subscription_refund(payment)
        
        # 6. í¬ë ˆë”§ì¸ ê²½ìš° í¬ë ˆë”§ ì°¨ê°
        if payment.payment_type == "one_time":
            await self._handle_credit_refund(payment, refund_amount)
        
        await self.db.commit()
        
        return RefundResult(
            success=True,
            refunded_amount=refund_amount,
            payment_status=payment.status
        )
    
    async def _validate_refund(
        self, 
        payment: Payment, 
        user_id: str,
        amount: Optional[int]
    ) -> ValidationResult:
        """í™˜ë¶ˆ ìœ íš¨ì„± ê²€ì¦"""
        
        # ë³¸ì¸ ê²°ì œì¸ì§€ í™•ì¸
        if str(payment.user_id) != user_id:
            return ValidationResult(False, "ë³¸ì¸ì˜ ê²°ì œë§Œ í™˜ë¶ˆ ê°€ëŠ¥í•©ë‹ˆë‹¤.")
        
        # ì´ë¯¸ í™˜ë¶ˆëœ ê²°ì œì¸ì§€ í™•ì¸
        if payment.status == "refunded":
            return ValidationResult(False, "ì´ë¯¸ í™˜ë¶ˆëœ ê²°ì œì…ë‹ˆë‹¤.")
        
        # ê²°ì œ í›„ 7ì¼ ì²´í¬
        days_since_payment = (datetime.now() - payment.paid_at).days
        
        if payment.payment_type == "subscription":
            if days_since_payment > 7:
                # 7ì¼ ì´ˆê³¼ ì‹œ ì‚¬ìš©ëŸ‰ ì²´í¬
                usage = await self._get_period_usage(payment.user_id)
                if usage > 0.5:
                    return ValidationResult(
                        False, 
                        "7ì¼ ì´ˆê³¼ ë° 50% ì´ìƒ ì‚¬ìš©í•˜ì—¬ í™˜ë¶ˆì´ ë¶ˆê°€í•©ë‹ˆë‹¤."
                    )
        
        return ValidationResult(True)
```

---

## 11. ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 11.1 ê²°ì œ ë³´ì•ˆ

```python
# í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì˜ˆì‹œ (.env)
# âš ï¸ ì ˆëŒ€ ì½”ë“œì— í•˜ë“œì½”ë”© ê¸ˆì§€!

# í† ìŠ¤í˜ì´ë¨¼ì¸  í‚¤
TOSS_CLIENT_KEY=test_ck_xxx        # í´ë¼ì´ì–¸íŠ¸ í‚¤ (ê³µê°œ ê°€ëŠ¥)
TOSS_SECRET_KEY=test_sk_xxx        # ì‹œí¬ë¦¿ í‚¤ (ì„œë²„ë§Œ!)

# ì•”í˜¸í™” í‚¤ (ë¹Œë§í‚¤ ì•”í˜¸í™”ìš©)
BILLING_KEY_ENCRYPTION_KEY=your-32-char-key-here

# ì›¹í›… ì‹œí¬ë¦¿
TOSS_WEBHOOK_SECRET=your-webhook-secret
```

### 11.2 ë³´ì•ˆ ì„¤ì • ì½”ë“œ

```python
# config/security.py

from cryptography.fernet import Fernet
import os

class SecurityConfig:
    """ë³´ì•ˆ ì„¤ì •"""
    
    # ë¹Œë§í‚¤ ì•”í˜¸í™”
    @staticmethod
    def encrypt_billing_key(billing_key: str) -> str:
        """ë¹Œë§í‚¤ AES ì•”í˜¸í™”"""
        key = os.environ["BILLING_KEY_ENCRYPTION_KEY"].encode()
        f = Fernet(key)
        return f.encrypt(billing_key.encode()).decode()
    
    @staticmethod
    def decrypt_billing_key(encrypted: str) -> str:
        """ë¹Œë§í‚¤ ë³µí˜¸í™”"""
        key = os.environ["BILLING_KEY_ENCRYPTION_KEY"].encode()
        f = Fernet(key)
        return f.decrypt(encrypted.encode()).decode()
    
    # ê²°ì œ ê¸ˆì•¡ ê²€ì¦
    @staticmethod
    def validate_payment_amount(
        product_type: str, 
        claimed_amount: int
    ) -> bool:
        """ì„œë²„ ì‚¬ì´ë“œ ê²°ì œ ê¸ˆì•¡ ê²€ì¦"""
        VALID_AMOUNTS = {
            "pro_monthly": 29900,
            "pro_yearly": 299000,
            "team_monthly": 99000,
            "team_yearly": 990000,
            "credits_basic": 9900,
            "credits_standard": 24900,
            "credits_premium": 49900,
        }
        
        expected = VALID_AMOUNTS.get(product_type)
        return expected is not None and expected == claimed_amount
```

---

## 12. ê°œë°œ ë¡œë“œë§µ (ê²°ì œ í¬í•¨)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CodeGen AI - 14ì£¼ ê°œë°œ ë¡œë“œë§µ (ê²°ì œ í¬í•¨)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  PHASE 1: Core (Week 1-4)                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•       â”‚
â”‚  Week 1-2: í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ + ë°±ì—”ë“œ ê¸°ì´ˆ                          â”‚
â”‚  Week 3-4: ì½˜í…ì¸  ìƒì„± API + ì½”ë“œ ê²€ì¦                               â”‚
â”‚  â˜… Milestone: Python ì„¤ëª…ë¬¸ ìƒì„± ì‘ë™                                â”‚
â”‚                                                                     â”‚
â”‚  PHASE 2: Features (Week 5-8)                                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•       â”‚
â”‚  Week 5-6: í”„ë¡ íŠ¸ì—”ë“œ + í€´ì¦ˆ/ì‹¤ìŠµ                                    â”‚
â”‚  Week 7-8: JS/SQL í™•ì¥ + PDF ë‚´ë³´ë‚´ê¸°                                â”‚
â”‚  â˜… Milestone: Alpha Release (3ê°œ ì–¸ì–´)                               â”‚
â”‚                                                                     â”‚
â”‚  PHASE 3: Payment (Week 9-11) â† ê²°ì œ ì‹œìŠ¤í…œ                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•       â”‚
â”‚  Week 9: í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™                                           â”‚
â”‚  â”œâ”€ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •                                                 â”‚
â”‚  â”œâ”€ ë‹¨ê±´ ê²°ì œ (í¬ë ˆë”§ êµ¬ë§¤) êµ¬í˜„                                     â”‚
â”‚  â””â”€ ê²°ì œ UI ê°œë°œ                                                     â”‚
â”‚                                                                     â”‚
â”‚  Week 10: ì •ê¸° ê²°ì œ (êµ¬ë…)                                           â”‚
â”‚  â”œâ”€ ë¹Œë§í‚¤ ë°œê¸‰/ì €ì¥ êµ¬í˜„                                            â”‚
â”‚  â”œâ”€ ìë™ ê²°ì œ ìŠ¤ì¼€ì¤„ëŸ¬                                               â”‚
â”‚  â”œâ”€ êµ¬ë… ê´€ë¦¬ UI                                                     â”‚
â”‚  â””â”€ ì›¹í›… ì²˜ë¦¬                                                        â”‚
â”‚                                                                     â”‚
â”‚  Week 11: í™˜ë¶ˆ + ê²°ì œ QA                                             â”‚
â”‚  â”œâ”€ í™˜ë¶ˆ ë¡œì§ êµ¬í˜„                                                   â”‚
â”‚  â”œâ”€ ê²°ì œ ì‹¤íŒ¨ ì²˜ë¦¬                                                   â”‚
â”‚  â”œâ”€ ê²°ì œ í”Œë¡œìš° ì „ì²´ í…ŒìŠ¤íŠ¸                                          â”‚
â”‚  â””â”€ ë³´ì•ˆ ê°ì‚¬                                                        â”‚
â”‚  â˜… Milestone: ê²°ì œ ì‹œìŠ¤í…œ ì™„ë£Œ                                       â”‚
â”‚                                                                     â”‚
â”‚  PHASE 4: Launch (Week 12-14)                                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•       â”‚
â”‚  Week 12: ë² íƒ€ í…ŒìŠ¤íŠ¸ (ê²°ì œ í¬í•¨)                                     â”‚
â”‚  Week 13: í”¼ë“œë°± ë°˜ì˜ + Java/TS ì¶”ê°€                                 â”‚
â”‚  Week 14: ì •ì‹ ì¶œì‹œ                                                  â”‚
â”‚  â˜… Milestone: Public Launch ğŸš€                                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 13. ìš´ì˜ ëŒ€ì‹œë³´ë“œ (ê²°ì œ ëª¨ë‹ˆí„°ë§)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CodeGen AI - Payment Dashboard                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [Revenue - This Month]                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚   MRR       â”‚  â”‚   New Sub   â”‚  â”‚  Churn Rate â”‚                 â”‚
â”‚  â”‚ â‚©4,850,000  â”‚  â”‚     47      â”‚  â”‚    3.2%     â”‚                 â”‚
â”‚  â”‚   â–² 12%    â”‚  â”‚   â–² 8%     â”‚  â”‚   â–¼ 0.5%   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                     â”‚
â”‚  [Subscription Distribution]                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Starter (Free)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  68%        â”‚ â”‚
â”‚  â”‚  Pro Monthly     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  22%                        â”‚ â”‚
â”‚  â”‚  Pro Yearly      â–ˆâ–ˆâ–ˆâ–ˆ  6%                                     â”‚ â”‚
â”‚  â”‚  Team           â–ˆâ–ˆ  4%                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  [Payment Status - Last 24h]                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  Success    â”‚  â”‚   Failed    â”‚  â”‚  Refunded   â”‚                 â”‚
â”‚  â”‚     127     â”‚  â”‚      3      â”‚  â”‚      2      â”‚                 â”‚
â”‚  â”‚    96.2%    â”‚  â”‚    2.3%     â”‚  â”‚    1.5%     â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                     â”‚
â”‚  [Alerts]                                                           â”‚
â”‚  âš ï¸ ê²°ì œ ì‹¤íŒ¨ìœ¨ 2% ì´ˆê³¼ (ì„ê³„ê°’: 2%)                                 â”‚
â”‚  âš ï¸ 3ëª… ê³ ê° ê²°ì œ ì¬ì‹œë„ í•„ìš”                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 14. ì„±ê³µ ì§€í‘œ (ê²°ì œ í¬í•¨)

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|------|----------|
| **ê²°ì œ ì „í™˜ìœ¨** | 8%+ | ê°€ì…ì â†’ ìœ ë£Œ ì „í™˜ |
| **MRR** | â‚©10M (Y1) | ì›”ê°„ ë°˜ë³µ ë§¤ì¶œ |
| **ê²°ì œ ì„±ê³µë¥ ** | 98%+ | ì„±ê³µ/ì‹œë„ |
| **í™˜ë¶ˆìœ¨** | <3% | í™˜ë¶ˆ/ì „ì²´ ê²°ì œ |
| **êµ¬ë… ìœ ì§€ìœ¨** | 85%+ | ì›”ê°„ ê°±ì‹ ìœ¨ |
| **LTV** | â‚©300,000+ | ê³ ê° ìƒì•  ê°€ì¹˜ |
| **CAC Payback** | <3ê°œì›” | íšë“ ë¹„ìš© íšŒìˆ˜ ê¸°ê°„ |

---

# ë¶€ë¡

## A. í† ìŠ¤í˜ì´ë¨¼ì¸  í…ŒìŠ¤íŠ¸ ì •ë³´

```yaml
# í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •

í…ŒìŠ¤íŠ¸ URL: https://api.tosspayments.com
í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ í‚¤: test_ck_... (ì½˜ì†”ì—ì„œ ë°œê¸‰)
í…ŒìŠ¤íŠ¸ ì‹œí¬ë¦¿ í‚¤: test_sk_... (ì½˜ì†”ì—ì„œ ë°œê¸‰)

# í…ŒìŠ¤íŠ¸ ì¹´ë“œ ë²ˆí˜¸
ì„±ê³µ: 4330000000000000 (ë§Œë£Œ: 12/24, CVC: 123, ë¹„ë°€ë²ˆí˜¸: 00)
ì‹¤íŒ¨: 4000000000000000
ì”ì•¡ë¶€ì¡±: 4111111111111111

# í…ŒìŠ¤íŠ¸ ì‹œ ì£¼ì˜ì‚¬í•­
- í…ŒìŠ¤íŠ¸ í‚¤ë¡œ ê²°ì œ ì‹œ ì‹¤ì œ ê²°ì œë˜ì§€ ì•ŠìŒ
- ì›¹í›…ì€ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë„ ë™ì‘
- ë¼ì´ë¸Œ ì „í™˜ ì „ ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ ê²°ì œ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦
```

## B. ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì¶œì‹œ ì „)

```
[ê²°ì œ ì‹œìŠ¤í…œ ì¶œì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸]

â˜ í† ìŠ¤í˜ì´ë¨¼ì¸  ì‹¬ì‚¬ ì™„ë£Œ
â˜ ì‚¬ì—…ìë“±ë¡ì¦ ë“±ë¡
â˜ ë¼ì´ë¸Œ API í‚¤ ë°œê¸‰
â˜ ì›¹í›… URL ë“±ë¡ (ë¼ì´ë¸Œ)
â˜ í™˜ë¶ˆ ì •ì±… í˜ì´ì§€ ê²Œì‹œ
â˜ ì´ìš©ì•½ê´€ ê²°ì œ ì¡°í•­ ì¶”ê°€
â˜ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ ê²°ì œ ì •ë³´ ì¶”ê°€
â˜ ê²°ì œ í”Œë¡œìš° ì „ì²´ í…ŒìŠ¤íŠ¸ (ë¼ì´ë¸Œ í‚¤)
â˜ PCI-DSS ì¤€ìˆ˜ í™•ì¸
â˜ ë³´ì•ˆ ê°ì‚¬ ì™„ë£Œ
â˜ ê²°ì œ ì‹¤íŒ¨ ì•Œë¦¼ ì„¤ì •
â˜ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ì„¤ì •
```

---

**ë¬¸ì„œ ë²„ì „**: 3.1 (í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œìŠ¤í…œ í¬í•¨)
**ì‘ì„±ì¼**: 2025-01-28
**ê²°ì œ PG**: í† ìŠ¤í˜ì´ë¨¼ì¸ 

---

*ì´ PRDëŠ” ì„±ì¸ ì½”ë”© êµìœ¡ + í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œìŠ¤í…œì„ í¬í•¨í•œ ì™„ì „í•œ ì„œë¹„ìŠ¤ ì„¤ê³„ì„œì…ë‹ˆë‹¤.*
